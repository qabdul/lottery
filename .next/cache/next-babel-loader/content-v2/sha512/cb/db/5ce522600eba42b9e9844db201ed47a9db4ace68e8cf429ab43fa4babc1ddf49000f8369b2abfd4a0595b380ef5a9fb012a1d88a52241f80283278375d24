{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/AbdulQ/Desktop/lottery/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/AbdulQ/Desktop/lottery/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState } from \"react\";\nimport Layout from \"../../../component/Layout\";\nimport NoDataFound from \"../../../component/NoDataFound\";\nimport { Button, Table, Grid, Message } from \"semantic-ui-react\";\nimport { Link } from \"../../../routes\";\nimport web3 from \"../../../etherium/web3\";\nimport Campaign from \"../../../etherium/Campaign\";\nimport RequestRow from \"../../../component/RequestRow\";\nimport ErrorMessage from \"../../../component/ErrorMessage\";\n\nvar index = function index(props) {\n  var Header = Table.Header,\n      Body = Table.Body,\n      HeaderCell = Table.HeaderCell,\n      Cell = Table.Cell,\n      Row = Table.Row;\n\n  var _useState = useState(\"\"),\n      data = _useState[0],\n      setData = _useState[1];\n\n  var setError = function setError(error) {\n    setData(error);\n  };\n\n  var renderRows = function renderRows() {\n    return props.requests.map(function (request, index) {\n      return /*#__PURE__*/_jsx(RequestRow, {\n        request: request,\n        address: props.address,\n        id: index,\n        total: props.totalApprovers,\n        setError: setError\n      }, index);\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(Layout, {\n    children: [/*#__PURE__*/_jsx(\"h3\", {\n      children: \"All the Request Created for this Campaign\"\n    }), /*#__PURE__*/_jsxs(Grid, {\n      children: [/*#__PURE__*/_jsx(Grid.Row, {\n        children: /*#__PURE__*/_jsxs(Grid.Column, {\n          children: [/*#__PURE__*/_jsx(Link, {\n            to: \"/campaigns/\".concat(props.address),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              children: [\" \", /*#__PURE__*/_jsx(Button, {\n                primary: true,\n                floated: \"left\",\n                children: \"Back\"\n              })]\n            })\n          }), \" \", /*#__PURE__*/_jsx(Link, {\n            to: \"/campaigns/\".concat(props.address, \"/requests/new\"),\n            children: /*#__PURE__*/_jsxs(\"a\", {\n              children: [\" \", /*#__PURE__*/_jsx(Button, {\n                primary: true,\n                floated: \"right\",\n                children: \"Create Request\"\n              })]\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(Grid.Row, {\n        children: /*#__PURE__*/_jsxs(Grid.Column, {\n          children: [/*#__PURE__*/_jsxs(Table, {\n            children: [/*#__PURE__*/_jsx(Header, {\n              children: /*#__PURE__*/_jsxs(Row, {\n                children: [/*#__PURE__*/_jsx(HeaderCell, {\n                  children: \"ID\"\n                }), /*#__PURE__*/_jsx(HeaderCell, {\n                  children: \"Description\"\n                }), /*#__PURE__*/_jsx(HeaderCell, {\n                  children: \"Amount\"\n                }), /*#__PURE__*/_jsx(HeaderCell, {\n                  children: \"Recepient\"\n                }), /*#__PURE__*/_jsx(HeaderCell, {\n                  children: \"Approval Count\"\n                }), /*#__PURE__*/_jsx(HeaderCell, {\n                  children: \"Approve\"\n                }), /*#__PURE__*/_jsx(HeaderCell, {\n                  children: \"Finalize\"\n                })]\n              })\n            }), /*#__PURE__*/_jsx(Table.Body, {\n              children: renderRows()\n            })]\n          }), props.requests.length === 0 ? /*#__PURE__*/_jsx(NoDataFound, {\n            message: \"Not Data Found, Please click on create Request button to create new one\"\n          }) : \"\", data === \"\" ? \"\" : /*#__PURE__*/_jsx(ErrorMessage, {\n            data: data\n          })]\n        })\n      })]\n    })]\n  });\n};\n\nindex.getInitialProps = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(props) {\n    var address, campaign, requestsCount, totalApprovers, requests;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            address = props.query.address;\n            campaign = Campaign(props.query.address);\n            _context.next = 4;\n            return campaign.methods.getRequestsCount().call();\n\n          case 4:\n            requestsCount = _context.sent;\n            _context.next = 7;\n            return campaign.methods.approversCount().call();\n\n          case 7:\n            totalApprovers = _context.sent;\n            _context.next = 10;\n            return Promise.all(Array(parseInt(requestsCount)).fill().map(function (element, index) {\n              return campaign.methods.requests(index).call();\n            }));\n\n          case 10:\n            requests = _context.sent;\n            console.log(requests);\n            return _context.abrupt(\"return\", {\n              address: address,\n              requests: requests,\n              requestsCount: requestsCount,\n              totalApprovers: totalApprovers\n            });\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport default index;","map":null,"metadata":{},"sourceType":"module"}